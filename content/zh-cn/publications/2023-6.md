---
title: "Cross Container Attacks: The Bewildered eBPF on Clouds"
excerpt: USENIX Security Symposium (Security) 2023
authors: Yi He*, Roland Guo*, Yunlong Xing, Xijia Che, Kun Sun, <strong>Zhuotao Liu</strong>, Ke Xu, Qi Li
pdf: https://www.usenix.org/system/files/usenixsecurity23-he.pdf
doi: https://www.usenix.org/conference/usenixsecurity23/presentation/he
seq: 2023-6
category: "System Security"
conference: "Sec23"
conference_url: "https://www.usenix.org/conference/usenixsecurity23"
abstract: "The extended Berkeley Packet Filter (eBPF) provides powerful and flexible kernel interfaces to extend the kernel functions
for user space programs via running bytecode directly in the
kernel space. It has been widely used by cloud services to
enhance container security, network management, and system
observability. However, we discover that the offensive eBPF
that has been extensively discussed in Linux hosts can bring
new attack surfaces to containers. With eBPF tracing features, attackers can break the container's isolation and attack
the host, e.g., steal sensitive data, DoS, and even escape the
container. In this paper, we study the eBPF-based cross container attacks and reveal their security impacts in real world
services. With eBPF attacks, we successfully compromise
five online Jupyter/Interactive Shell services and the Cloud
Shell of Google Cloud Platform. Furthermore, we find that
the Kubernetes services offered by three leading cloud vendors can be exploited to launch cross-node attacks after the
attackers escape the container via eBPF. Specifically, in Alibaba's Kubernetes services, attackers can compromise the
whole cluster by abusing their over-privileged cloud metrics
or management Pods. Unfortunately, the eBPF attacks on containers are seldom known and can hardly be discovered by
existing intrusion detection systems. Also, the existing eBPF
permission model cannot confine the eBPF and ensure secure
usage in shared-kernel container environments. To this end,
we propose a new eBPF permission model to counter the
eBPF attacks in containers."
---
